#Federated Learning Linear Model
```{r}
library(readxl)
library(dplyr)

neyan <- read_excel("VENTURE_baseline_data.xlsx", sheet="neyan_data")
eawerner <- read_excel("VENTURE_baseline_data.xlsx", sheet="eawerner_data")
vikbala <- read_excel("VENTURE_baseline_data.xlsx", sheet="vikbala_data")

X_neyan <- as.matrix(cbind(1, neyan$Pickups, neyan$Num.Classes, neyan$DPSST))
Y_neyan <- as.matrix(neyan$Total.ST.min)

X_vikbala <- as.matrix(cbind(1, vikbala$Pickups, vikbala$Num.Classes, vikbala$DPSST))
Y_vikbala <- as.matrix(vikbala$Total.ST.min)

X_eawerner <- as.matrix(cbind(1, eawerner$Pickups, eawerner$Num.Classes, eawerner$DPSST))
Y_eawerner <- as.matrix(eawerner$Total.ST.min)

XTX <- function(Y,X){
  return(t(X) %*% X)
}
XTY <- function(Y,X){
  return(t(X) %*% Y)
}

XTX_global <- XTX(Y_neyan, X_neyan) + XTX(Y_vikbala, X_vikbala) + XTX(Y_eawerner, X_eawerner)
XTY_global <- XTY(Y_neyan, X_neyan) + XTY(Y_vikbala, X_vikbala) + XTY(Y_eawerner, X_eawerner)

beta_global <- as.numeric(solve(XTX_global) %*% XTY_global)
coef_names <- c("(Intercept)", "Pickups", "Num.Classes", "Hrs.Classes")
names(beta_global) <- coef_names
print(beta_global)
```

#Original Linear Model
```{r}
combined_data <- read_excel("VENTURE_baseline_data.xlsx", sheet="combined_raw_data")
mod <- lm(Total.ST.min ~ Pickups + Num.Classes + DPSST, data = combined_data)
print(mod$coefficients)
```

#Assumption Test
```{r}
library(car)
plot(mod)
vif(mod)

```

#ACF
```{r}
acf_neyan = acf(neyan$Total.ST.min, plot = TRUE, main="ACF of Daily Total Screen Time (neyan)")
acf_eawerner = acf(eawerner$Total.ST.min, plot = TRUE, main="ACF of Daily Total Screen Time (eawerner)")
acf_vikbala = acf(vikbala$Total.ST.min, plot = TRUE, main="ACF of Daily Total Screen Time (vikbala)")
print(acf_neyan)
print(acf_eawerner)
print(acf_vikbala)
```


